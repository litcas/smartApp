apiready=function(){api.showProgress({title:"加载地图中...",modal:!1}),setTimeout(function(){api.hideProgress()},5e3),apiready_init(),vm.aMapLBS=api.require("aMapLBS"),vm.aMap=api.require("aMap")};var vm=new Vue({el:"#wrap",data:{searchValue:"",mapShowPicker:!1,mapColumnsDefault:"0",mapColumns:[{text:"矢量地图",value:"sldt",key:"0"},{text:"卫星地图",value:"yxdt",key:"1"},{text:"地形地图",value:"dxdt",key:"2"}],fwcxing:!1,aMapLBS:null,aMap:null,timeoutStamp:null,ro:{}},methods:{onClickLeft:function(){this.closeWin()},openW:function(t){this.openWin(t,window.geometry_pageParam)},fwcxCLick:function(){this.fwcxing=!0,window.userCustomObj.fwcxClick()},fwcxComplete:function(){window.userCustomObj.sketchViewModel.complete()},fwcxCancal:function(){window.userCustomObj.sketchViewModel.cancel(),this.fwcxing=!1},changeMapOnConfirm:function(t){window.userCustomObj.changeMap(t.value),this.mapColumnsDefault=t.key,this.mapShowPicker=!1},changeMapClick:function(){this.mapShowPicker=!0},drawLocation:function(){var e=this.aMapLBS,a=this;e&&(a.timeoutStamp?window.userCustomObj.centerAt(a.ro.lon,a.ro.lat):(api.showProgress({text:"努力定位中...",modal:!1}),e.configManager({accuracy:"best",filter:1},function(t,o){t.status&&e.singleLocation({timeout:6},function(t,o){if(t.status){var e=window._coordinate(t.lat,t.lon);a.ro=e,window.userCustomObj.drawLocation(e.lon,e.lat),window.userCustomObj.centerAt(e.lon,e.lat)}a.refreshLocation(),api.hideProgress()})})))},refreshLocation:function(){var n=this;n.timeoutStamp=window.setTimeout(function a(){n.aMapLBS.singleLocation({timeout:6},function(t,o){if(t.status){window.userCustomObj.clearUpSelection();var e=window._coordinate(t.lat,t.lon);n.ro=e,window.userCustomObj.drawLocation(e.lon,e.lat),n.timeoutStamp=window.setTimeout(a,8e3)}else n.timeoutStamp=window.setTimeout(a,8e3)})},8e3)},onSearch:function(){window.userCustomObj.clearMarker();var t=window.userCustomObj.getCenterPoint(),a=this;this.aMap.getNameFromCoords({lon:t.lon,lat:t.lat},function(t,o){t.status?a.aMap.getCoordsFromName({city:t.city,address:a.searchValue},function(t,o){if(t.status){var e=window._coordinate(t.lat,t.lon);window.userCustomObj.addMarker(e.lon,e.lat),window.userCustomObj.centerAt(e.lon,e.lat)}else a.$toast.fail("未查询到结果")}):a.$toast.fail("未查询到结果")})},onClear:function(){window.userCustomObj.clearMarker()}},mounted:function(){}});